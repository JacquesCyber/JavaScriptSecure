<div class="container-fluid">
  <div class="row mb-4">
    <div class="col">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="#" data-page="pending-payments">Pending Payments</a>
          </li>
          <li class="breadcrumb-item">
            <a href="#" data-page="verify-payment">Verify Payment</a>
          </li>
          <li class="breadcrumb-item active" aria-current="page">Submit to SWIFT</li>
        </ol>
      </nav>
      <h2 class="text-success">
        <i class="bi bi-send-check"></i> Submit Payment to SWIFT Network
      </h2>
      <p class="text-muted">Final step: Generate MT103 message and submit to SWIFT</p>
    </div>
  </div>

  <!-- Alert for status messages -->
  <div id="submit-swift-alert" class="alert alert-dismissible fade show d-none" role="alert">
    <span id="submit-swift-message"></span>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>

  <!-- Loading State -->
  <div id="swift-loading" class="text-center py-5">
    <div class="spinner-border text-success" role="status">
      <span class="visually-hidden">Preparing SWIFT message...</span>
    </div>
    <p class="mt-2 text-muted">Preparing SWIFT MT103 message...</p>
  </div>

  <!-- SWIFT Submission Container -->
  <div id="swift-submission-container" class="d-none">

    <!-- Payment Summary -->
    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card shadow-lg border-success">
          <div class="card-header bg-success text-white">
            <h4 class="mb-0">
              <i class="bi bi-check-circle"></i> Approved Payment Summary
            </h4>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6">
                <div class="mb-2">
                  <strong>Transaction ID:</strong>
                  <span id="summary-transaction-id" class="float-end"></span>
                </div>
                <div class="mb-2">
                  <strong>Customer:</strong>
                  <span id="summary-customer-name" class="float-end"></span>
                </div>
                <div class="mb-2">
                  <strong>Amount:</strong>
                  <span id="summary-amount" class="float-end text-success fs-5"></span>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-2">
                  <strong>Beneficiary:</strong>
                  <span id="summary-beneficiary-name" class="float-end"></span>
                </div>
                <div class="mb-2">
                  <strong>SWIFT Code:</strong>
                  <span id="summary-swift-code" class="float-end"></span>
                </div>
                <div class="mb-2">
                  <strong>IBAN:</strong>
                  <span id="summary-iban" class="float-end"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SWIFT MT103 Message Preview -->
    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card shadow">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0">
              <i class="bi bi-file-text"></i> SWIFT MT103 Message Preview
            </h5>
          </div>
          <div class="card-body">
            <div class="alert alert-info">
              <i class="bi bi-info-circle"></i>
              <strong>Message Type:</strong> MT103 - Single Customer Credit Transfer
            </div>
            
            <div class="mb-3">
              <label class="form-label fw-bold">SWIFT Message Content:</label>
              <pre class="bg-dark text-light p-3 rounded" id="swift-message-preview" style="font-family: 'Courier New', monospace; font-size: 0.9rem; white-space: pre-wrap; word-wrap: break-word;"></pre>
            </div>

            <div class="row">
              <div class="col-md-4">
                <div class="mb-2">
                  <strong>Message Type:</strong>
                  <span class="float-end">MT103</span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-2">
                  <strong>Message Priority:</strong>
                  <span class="float-end badge bg-warning text-dark">NORMAL</span>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mb-2">
                  <strong>Value Date:</strong>
                  <span id="value-date" class="float-end"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SWIFT Field Breakdown -->
    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card shadow">
          <div class="card-header bg-info text-white">
            <h5 class="mb-0">
              <i class="bi bi-list-ol"></i> MT103 Field Breakdown
            </h5>
          </div>
          <div class="card-body">
            <table class="table table-hover table-striped">
              <thead class="table-dark">
                <tr>
                  <th>Field</th>
                  <th>Tag</th>
                  <th>Description</th>
                  <th>Value</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="swift-fields-tbody">
                <!-- Fields will be populated dynamically -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Validation Checklist -->
    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card shadow">
          <div class="card-header bg-warning text-dark">
            <h5 class="mb-0">
              <i class="bi bi-clipboard-check"></i> Pre-Submission Validation
            </h5>
          </div>
          <div class="card-body">
            <div class="list-group" id="validation-checklist">
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                  <i class="bi bi-check-circle-fill text-success"></i>
                  SWIFT/BIC code validated
                </span>
                <span class="badge bg-success">Passed</span>
              </div>
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                  <i class="bi bi-check-circle-fill text-success"></i>
                  IBAN checksum verified
                </span>
                <span class="badge bg-success">Passed</span>
              </div>
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                  <i class="bi bi-check-circle-fill text-success"></i>
                  AML compliance cleared
                </span>
                <span class="badge bg-success">Passed</span>
              </div>
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                  <i class="bi bi-check-circle-fill text-success"></i>
                  Fraud score acceptable
                </span>
                <span class="badge bg-success">Passed</span>
              </div>
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                  <i class="bi bi-check-circle-fill text-success"></i>
                  Beneficiary details complete
                </span>
                <span class="badge bg-success">Passed</span>
              </div>
              <div class="list-group-item d-flex justify-content-between align-items-center">
                <span>
                  <i class="bi bi-check-circle-fill text-success"></i>
                  Employee verification completed
                </span>
                <span class="badge bg-success">Passed</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Submission Confirmation -->
    <div class="row mb-4">
      <div class="col-md-12">
        <div class="card shadow border-danger">
          <div class="card-header bg-danger text-white">
            <h5 class="mb-0">
              <i class="bi bi-exclamation-triangle-fill"></i> Final Confirmation Required
            </h5>
          </div>
          <div class="card-body">
            <div class="alert alert-warning">
              <i class="bi bi-shield-exclamation"></i>
              <strong>Important:</strong> Once submitted, this transaction cannot be reversed. 
              Ensure all details are correct before proceeding.
            </div>

            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="confirm-details-check" required>
              <label class="form-check-label" for="confirm-details-check">
                I have verified all payment details and confirm they are correct
              </label>
            </div>

            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="confirm-compliance-check" required>
              <label class="form-check-label" for="confirm-compliance-check">
                I confirm this payment meets all AML and compliance requirements
              </label>
            </div>

            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="confirm-authorization-check" required>
              <label class="form-check-label" for="confirm-authorization-check">
                I am authorized to approve and submit international payments
              </label>
            </div>

            <hr>

            <div class="mb-3">
              <label for="employee-password-confirm" class="form-label">
                <i class="bi bi-key-fill"></i> Enter your password to confirm:
              </label>
              <input 
                type="password" 
                class="form-control" 
                id="employee-password-confirm" 
                placeholder="Enter your employee password"
                required
                autocomplete="current-password"
              >
              <div class="form-text">
                Password confirmation required for audit trail
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <button 
                  type="button" 
                  class="btn btn-success btn-lg w-100" 
                  id="submit-to-swift-btn"
                  disabled
                >
                  <i class="bi bi-send-fill"></i> Submit to SWIFT Network
                </button>
              </div>
              <div class="col-md-6">
                <button 
                  type="button" 
                  class="btn btn-secondary btn-lg w-100" 
                  id="cancel-submission-btn"
                >
                  <i class="bi bi-x-circle"></i> Cancel
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Submission Progress (hidden initially) -->
    <div id="submission-progress" class="d-none">
      <div class="card shadow-lg border-success">
        <div class="card-body text-center py-5">
          <div class="spinner-border text-success" style="width: 3rem; height: 3rem;" role="status">
            <span class="visually-hidden">Submitting to SWIFT...</span>
          </div>
          <h4 class="mt-3 text-success">Submitting to SWIFT Network...</h4>
          <p class="text-muted">Please wait while we process your submission</p>
          <div class="progress mt-3" style="height: 30px;">
            <div 
              class="progress-bar progress-bar-striped progress-bar-animated bg-success" 
              role="progressbar" 
              id="submission-progress-bar"
              style="width: 0%"
              aria-valuenow="0" 
              aria-valuemin="0" 
              aria-valuemax="100"
            >
              <span id="progress-text">0%</span>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Success Modal -->
<div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true" data-bs-backdrop="static">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 class="modal-title" id="successModalLabel">
          <i class="bi bi-check-circle-fill"></i> Payment Successfully Submitted
        </h5>
      </div>
      <div class="modal-body text-center">
        <i class="bi bi-check-circle display-1 text-success"></i>
        <h4 class="mt-3">SWIFT Submission Successful!</h4>
        <p class="text-muted">The payment has been successfully submitted to the SWIFT network.</p>
        
        <div class="alert alert-info text-start mt-3">
          <div class="mb-2">
            <strong>SWIFT Reference:</strong>
            <span id="swift-reference" class="float-end"></span>
          </div>
          <div class="mb-2">
            <strong>Submission Time:</strong>
            <span id="submission-time" class="float-end"></span>
          </div>
          <div class="mb-2">
            <strong>Expected Settlement:</strong>
            <span id="expected-settlement" class="float-end"></span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="view-next-payment-btn">
          <i class="bi bi-arrow-right"></i> View Next Payment
        </button>
        <button type="button" class="btn btn-secondary" id="back-to-dashboard-btn">
          <i class="bi bi-house"></i> Back to Dashboard
        </button>
      </div>
    </div>
  </div>
</div>

<script>
// Enable submit button only when all checkboxes are checked
document.addEventListener('DOMContentLoaded', () => {
  const confirmDetailsCheck = document.getElementById('confirm-details-check');
  const confirmComplianceCheck = document.getElementById('confirm-compliance-check');
  const confirmAuthCheck = document.getElementById('confirm-authorization-check');
  const submitBtn = document.getElementById('submit-to-swift-btn');

  function checkAllConfirmations() {
    if (confirmDetailsCheck && confirmComplianceCheck && confirmAuthCheck && submitBtn) {
      const allChecked = confirmDetailsCheck.checked && 
                        confirmComplianceCheck.checked && 
                        confirmAuthCheck.checked;
      submitBtn.disabled = !allChecked;
    }
  }

  if (confirmDetailsCheck) confirmDetailsCheck.addEventListener('change', checkAllConfirmations);
  if (confirmComplianceCheck) confirmComplianceCheck.addEventListener('change', checkAllConfirmations);
  if (confirmAuthCheck) confirmAuthCheck.addEventListener('change', checkAllConfirmations);
});
</script>
